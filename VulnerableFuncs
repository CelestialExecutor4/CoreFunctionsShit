local VulnFuncs = {
    "PostAsync",
    "HttpPost",
    "PostAsyncFullUrl",
    "PerformPurchaseV2",
    "PromptBundlePurchase",
    "PromptGamePassPurchase",
    "PromptProductPurchase",
    "PromptPurchase",
    "PromptRobloxPurchase",
    "PromptThirdPartyPurchase",
    "OpenBrowserWindow",
    "OpenNativeOverlay",
    "AddCoreScriptLocal",
    "EmitHybridEvent",
    "ExecuteJavaScript",
    "ReturnToJavaScript",
    "SendCommand",
    "Call",
    "OpenUrl",
    "SaveScriptProfilingData",
    "GetLast",
    "GetMessageId", 
    "GetProtocolMethodRequestMessageId",
    "GetProtocolMethodResponseMessageId",
    "MakeRequest",
    "Publish",
    "PublishProtocolMethodRequest",
    "PublishProtocolMethodResponse",
    "Subscribe",
    "SubscribeToProtocolMethodRequest",
    "SubscribeToProtocolMethodResponse",
    "GetRobuxBalance",
    "GetAsyncFullUrl",
    "PromptNativePurchaseWithLocalPlayer",
    "PromptNativePurchase",
    "PromptCollectiblesPurchase",
    "GetAsync",
    "RequestInternal",
    "HttpRequestAsync",
    "RequestAsync",
    "OpenScreenshotsFolder",
    "Load",
    "GetUserSubscriptionDetailsInternalAsync",
    "GetUserSubscriptionStatusAsync",
    "PerformBulkPurchase",
    "PerformCancelSubscription",
    "PerformPurchase",
    "PerformSubscriptionPurchase",
    "PerformSubscriptionPurchaseV2",
    "PrepareCollectiblesPurchase",
    "PromptBulkPurchase",
    "PromptCancelSubscription",
    "PromptPremiumPurchase",
    "PromptSubscriptionPurchase",
    "OpenWeChatAuthWindow",
    "RequestLimitedAsync",
    "Run",
    "CaptureScreenshot",
    "CreatePostAsync",
    "DeleteCapture",
    "DeleteCapturesAsync",
    "GetCaptureFilePathAsync",
    "SaveCaptureToExternalStorage",
    "SaveCapturesToExternalStorageAsync",
    "GetCaptureUploadDataAsync",
    "RetrieveCaptures",
    "SaveScreenshotCapture",
    "GetCredentialsHeaders",
    "GetDeviceIntegrityToken",
    "GetDeviceIntegrityTokenYield",
    "NoPromptCreateOutfit",
    "NoPromptDeleteOutfit",
    "NoPromptRenameOutfit",
    "NoPromptSaveAvatar",
    "NoPromptSaveAvatarThumbnailCustomization",
    "NoPromptSetFavorite",
    "NoPromptUpdateOutfit",
    "PerformCreateOutfitWithDescription",
    "PerformRenameOutfit",
    "PerformSaveAvatarWithDescription",
    "PerformSetFavorite",
    "PerformUpdateOutfit",
    "PromptCreateOutfit",
    "PromptDeleteOutfit",
    "PromptRenameOutfit",
    "PromptSaveAvatar",
    "PromptSetFavorite",
    "PromptUpdateOutfit".
    "ToggleRecording",
    "TakeScreenshot"
}

function checkVulnerableFunction(funcName)
    for _, vulnFunc in ipairs(VulnFuncs) do
        if funcName == vulnFunc then
            -- If a vulnerable function is called, trigger the notification
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "Celestial Security", 
                Text = "âš  A script you just ran attempted to execute a dangerous function: " .. funcName,
                Duration = 5
            })
            return true
        end
    end
    return false
end
